# -_visualstudiooraclepersistence_app_winforms_documentacion_y_codigo-.

<img width="512" height="512" alt="logo_app" src="https://github.com/user-attachments/assets/3dd454d9-35e1-4ad5-819d-e72789fffb86" />  

# VisualStudio Oracle Persistence App (WinForms) — Documentación y Código

<img width="2552" height="1078" alt="image" src="https://github.com/user-attachments/assets/abd44c8a-6190-4188-9bf4-9c175fd13a62" />  

**Proyecto:** Visual Studio 2022 — WinForms (.NET 6)  
**Persistencia:** Oracle 19c (Oracle.ManagedDataAccess.Core)  
**Contenido:** README con documentación completa, código fuente (archivos C# incluidos), script SQL para la tabla, y un logo en SVG.

---

## Descripción general

Aplicación de escritorio simple en Windows Forms que permite:

- Registrar personas (Nombre, Email) en una tabla Oracle.
- Mostrar registros guardados en un `DataGridView`.
- Manejo básico de errores y mensajes al usuario.

El objetivo es ser un ejemplo educativo y listo para adaptar a un proyecto más grande.

---

## Requisitos

- Visual Studio 2022 (Community/Pro/Enterprise) con soporte para .NET 6.
- .NET 6 SDK instalado.
- Oracle Database 19c accesible (local o remoto).
- Paquete NuGet: `Oracle.ManagedDataAccess.Core` (para .NET Core/.NET 6)
  - En Visual Studio: **Tools → NuGet Package Manager → Manage NuGet Packages for Solution...** → Buscar `Oracle.ManagedDataAccess.Core` e instalar.
- Cadena de conexión Oracle (ver ejemplo más abajo).

---

## Script SQL (crear tabla)

Ejecute este script en su esquema Oracle (por ejemplo, con SQL*Plus, SQL Developer, etc.):

```sql
CREATE TABLE PERSONS (
  ID      NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  NAME    VARCHAR2(200),
  EMAIL   VARCHAR2(200),
  CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP
);

-- Privilegios (si necesita crear usuario/owner)
-- CREATE USER app_user IDENTIFIED BY tu_password;
-- GRANT CONNECT, RESOURCE TO app_user;
-- ALTER USER app_user QUOTA UNLIMITED ON USERS;
```

---

## Estructura del proyecto

Archivos principales incluidos en este README (cópialos y pégalos en tu proyecto Visual Studio):

- `Program.cs` — entrada de la aplicación.
- `MainForm.cs` — formulario principal con lógica UI.
- `DataAccess.cs` — capa simple de acceso a Oracle.
- `appsettings.txt` — ejemplo simple para la cadena de conexión (opcional).

> Nota: también puedes crear el proyecto con el diseñador de WinForms y luego mover el contenido de `MainForm.cs` al archivo principal.

---

## Cadena de conexión (ejemplo)

```text
User Id=APP_USER;Password=TuPassword;Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=127.0.0.1)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=ORCLCDB)));
```

Ajuste `HOST`, `PORT` y `SERVICE_NAME` según su instalación. Si usa TNS alias en `tnsnames.ora`, puede usar `Data Source=ORCL`.

---

## Código completo (copiar en archivos .cs)

---

### Program.cs

```csharp
using System;
using System.Windows.Forms;

namespace OracleWinFormsApp
{
    static class Program
    {
        [STAThread]
        static void Main()
        {
            Application.SetHighDpiMode(HighDpiMode.SystemAware);
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new MainForm());
        }
    }
}
```

---

### DataAccess.cs

```csharp
using System;
using System.Collections.Generic;
using System.Data;
using Oracle.ManagedDataAccess.Client;

namespace OracleWinFormsApp
{
    public class Person
    {
        public long Id { get; set; }
        public string Name { get; set; }
        public string Email { get; set; }
        public DateTime CreatedAt { get; set; }
    }

    public class DataAccess : IDisposable
    {
        private OracleConnection _connection;

        public DataAccess(string connectionString)
        {
            _connection = new OracleConnection(connectionString);
            _connection.Open();
        }

        public void Dispose()
        {
            try { _connection?.Close(); }
            catch { }
            _connection = null;
        }

        public void InsertPerson(string name, string email)
        {
            using (var cmd = _connection.CreateCommand())
            {
                cmd.CommandText = "INSERT INTO PERSONS (NAME, EMAIL) VALUES (:name, :email)";
                cmd.Parameters.Add(new OracleParameter("name", OracleDbType.Varchar2, name, ParameterDirection.Input));
                cmd.Parameters.Add(new OracleParameter("email", OracleDbType.Varchar2, email, ParameterDirection.Input));
                cmd.ExecuteNonQuery();
            }
        }

        public List<Person> GetPersons()
        {
            var list = new List<Person>();
            using (var cmd = _connection.CreateCommand())
            {
                cmd.CommandText = "SELECT ID, NAME, EMAIL, CREATED_AT FROM PERSONS ORDER BY ID";
                using (var reader = cmd.ExecuteReader())
                {
                    while (reader.Read())
                    {
                        var p = new Person
                        {
                            Id = reader.GetInt64(0),
                            Name = reader.IsDBNull(1) ? null : reader.GetString(1),
                            Email = reader.IsDBNull(2) ? null : reader.GetString(2),
                            CreatedAt = reader.IsDBNull(3) ? DateTime.MinValue : reader.GetDateTime(3)
                        };
                        list.Add(p);
                    }
                }
            }
            return list;
        }
    }
}
```

---

### MainForm.cs

```csharp
using System;
using System.Collections.Generic;
using System.Windows.Forms;

namespace OracleWinFormsApp
{
    public class MainForm : Form
    {
        private TextBox txtName;
        private TextBox txtEmail;
        private Button btnSave;
        private DataGridView dgv;
        private Label lblStatus;

        // Cambie la cadena a la suya o lea de un archivo de configuración.
        private string connectionString = "User Id=APP_USER;Password=TuPassword;Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=127.0.0.1)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=ORCLCDB)));";

        public MainForm()
        {
            InitializeComponent();
            LoadData();
        }

        private void InitializeComponent()
        {
            this.Text = "Oracle WinForms App - Registro sencillo";
            this.Width = 700;
            this.Height = 480;
            this.StartPosition = FormStartPosition.CenterScreen;

            var lbl1 = new Label() { Text = "Nombre:", Left = 20, Top = 20, Width = 80 };
            txtName = new TextBox() { Left = 110, Top = 18, Width = 400 };

            var lbl2 = new Label() { Text = "Email:", Left = 20, Top = 58, Width = 80 };
            txtEmail = new TextBox() { Left = 110, Top = 56, Width = 400 };

            btnSave = new Button() { Text = "Guardar", Left = 110, Top = 92, Width = 120 };
            btnSave.Click += BtnSave_Click;

            lblStatus = new Label() { Text = "", Left = 250, Top = 96, Width = 400 };

            dgv = new DataGridView()
            {
                Left = 20,
                Top = 140,
                Width = 640,
                Height = 280,
                ReadOnly = true,
                AllowUserToAddRows = false,
                AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill
            };

            this.Controls.Add(lbl1);
            this.Controls.Add(txtName);
            this.Controls.Add(lbl2);
            this.Controls.Add(txtEmail);
            this.Controls.Add(btnSave);
            this.Controls.Add(lblStatus);
            this.Controls.Add(dgv);
        }

        private void BtnSave_Click(object sender, EventArgs e)
        {
            var name = txtName.Text.Trim();
            var email = txtEmail.Text.Trim();

            if (string.IsNullOrEmpty(name))
            {
                MessageBox.Show("Ingrese un nombre.", "Validación", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                txtName.Focus();
                return;
            }

            try
            {
                using (var db = new DataAccess(connectionString))
                {
                    db.InsertPerson(name, email);
                }
                lblStatus.Text = "Guardado correctamente.";
                txtName.Text = "";
                txtEmail.Text = "";
                LoadData();
            }
            catch (Exception ex)
            {
                MessageBox.Show("Error al guardar: " + ex.Message, "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
                lblStatus.Text = "Error: " + ex.Message;
            }
        }

        private void LoadData()
        {
            try
            {
                List<Person> rows;
                using (var db = new DataAccess(connectionString))
                {
                    rows = db.GetPersons();
                }
                dgv.DataSource = rows;
            }
            catch (Exception ex)
            {
                lblStatus.Text = "Error leyendo datos: " + ex.Message;
            }
        }
    }
}
```

---

## Cómo ejecutar (paso a paso)

1. Abra Visual Studio 2022.
2. Cree un nuevo proyecto: **Windows Forms App** → Seleccione .NET 6 (o versión compatible).
3. Añada los 3 archivos `.cs` mostrados arriba al proyecto (Program.cs, DataAccess.cs, MainForm.cs).
4. Instale NuGet: `Oracle.ManagedDataAccess.Core`.
5. Modifique la cadena de conexión con sus credenciales y detalles de servidor Oracle.
6. Cree la tabla `PERSONS` en su BD (usar el script SQL).
7. Compile y ejecute (F5). Ingrese nombre y email y presione **Guardar**.

---

## Notas y recomendaciones

- Para producción, no guarde la contraseña en texto plano. Use un archivo seguro, encriptación o Managed Identity cuando corresponda.
- Considere usar `using` y transacciones si su lógica es más compleja.
- Si prefiere `Oracle.ManagedDataAccess.Client` para .NET Framework, instale el paquete adecuado y cambie `Oracle.ManagedDataAccess.Core` en las referencias.
- Para entornos con tnsnames.ora, la `Data Source` puede ser simplemente el alias TNS.

---

## Archivos incluidos

- `README_VisualStudio_OracleApp.md` (este documento)
- `logo_app.svg` (logo simple en SVG)

---

## Licencia

Este ejemplo es de uso libre para aprendizaje y adaptación. - Giovanny Alejandro Tapiero Cataño & chatgpt :. .
